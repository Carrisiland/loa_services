{# vim: set ts=2 sw=2 et tw=120 ft=htmldjango: #}

{% extends "skel.html" %}

{% set service = 'youtube' %}
{%set comments = post.comments%}
{% block title %} New Post {% endblock %}
{% block body %}

<div class="center-margin">
  <div id="player">{{post.title}}</div>
</div>
    <button name="upvotes"><i class="thumbs up outline icon"></i>{{post.upvotes}}</button>
    <button name="downvotes"><i class="thumbs down outline icon"></i>{{post.downvotes}}</button>
    <br>


<div class="ui comments center-margin">
  <h3 class="ui dividing header">Comments</h3>
  {% for comment in post.comments%}
  <div class="comment">
    <div class="content">
      {% if comment.user%}
      <a class="author">{{comment.user.username}}</a>
      {% else %}
        <a class="author">Anonymous</a>
        {% endif %}
      <div class="metadata">
        <span class="date">{{comment.dateCreated}}</span>
      </div>
      <div class="text">
        {{comment.text}}
      </div>
      <div class="actions">
        <a class="reply">Reply</a>
        <button onclick=''><i class="thumbs up outline icon"></i>{{comment.upvotes}}</button>
        <button><i class="thumbs down outline icon"></i>{{comment.downvotes}}</button>
      </div>

    </div>
  </div>
  {% endfor %}

  <form class="ui reply form" method="POST" action="/post/comment/{{post.id}}">
    <div class="field">
      <textarea name='reply'></textarea>
    </div>
    <button class="ui blue labeled submit icon button">
      <i class="icon edit"></i> Add Reply
    </button>
  </form>
</div>
{% endblock %}

{% block scripts %}

{% if service == 'vimeo' %}
<script src="https://player.vimeo.com/api/player.js"></script>
<script src="/videoPlayerScripts/vimeoHandler.js"></script>
{% else %}
<script src="https://www.youtube.com/iframe_api"></script>
<script src="/videoPlayerScripts/youtubeHandler.js"></script>
<script src="/js/viewClip.js"></script>
<script type="application/json" id="selected-video">
  {{ video | json | safe }}
</script>
<script>
var post = JSON.parse($('#selected-video').html());
console.log(post)
console.log(post.video.link)
loadVideo(post.video.link, post.video.start, post.video.end);
</script>
{% endif %}

{% endblock %}
